<div class="page-wrapper">

  <div class="profile-container">
    <header class="profile-header">
      <h2>Meu Perfil</h2>
      <button (click)="toggleEditMode()">{{ editMode ? 'Cancelar' : 'Editar Perfil' }}</button>
    </header>

    <section *ngIf="!editMode" class="profile-view">
      
      <div class="profile-summary">
        <div class="avatar-placeholder">
          <span>{{ currentUser.nomeCompleto.charAt(0) }}</span>
        </div>
        <div class="user-details">
          <h3 class="user-name">{{ currentUser.nomeCompleto }}</h3>
          <p class="user-email">{{ currentUser.email }}</p>
        </div>
      </div>

      <div class="profile-section">
        <h4>Dados Físicos</h4>
        <div class="info-grid">
          <div class="info-item">
            <label>Altura</label>
            <span>{{ currentUser.alturaEmCm }} cm</span>
          </div>
          <div class="info-item">
            <label>Peso</label>
            <span>{{ currentUser.pesoEmKg }} Kg</span>
          </div>
          <div class="info-item">
            <label>Data de Nascimento</label>
            <span>{{ currentUser.dataNascimento | date:'dd/MM/yyyy' }}</span>
          </div>
          <div class="info-item">
            <label>Gênero</label>
            <span>{{ generoTexto }}</span>
          </div>
        </div>
      </div>

      <div class="profile-section">
        <h4>Meu Plano Atual</h4>
        <div class="info-grid">
          <div class="info-item">
            <label>Objetivo</label>
            <span>{{ objetivoTexto }}</span>
          </div>
          <div class="info-item">
            <label>Nível de Atividade</label>
            <span>{{ nivelAtividadeTexto }}</span>
          </div>
        </div>
      </div>
    </section>

    <section *ngIf="editMode" class="profile-edit">
      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        
        <div class="form-group">
          <label for="nomeCompleto">Nome Completo *</label>
          <input type="text" id="nomeCompleto" formControlName="nomeCompleto" placeholder="Digite seu nome completo">
        </div>

        <div class="form-group">
          <label for="email">Email *</label>
          <input 
            type="email" 
            id="email" 
            formControlName="email" 
            placeholder="seu@email.com"
            [class.invalid]="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
          <span class="error-message" *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
            Email inválido
          </span>
        </div>

        <div class="form-group">
          <label for="dataNascimento">Data de Nascimento *</label>
          <input type="date" id="dataNascimento" formControlName="dataNascimento">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="alturaEmCm">Altura (cm) *</label>
            <input type="number" id="alturaEmCm" formControlName="alturaEmCm" placeholder="Ex: 170">
          </div>

          <div class="form-group">
            <label for="pesoEmKg">Peso (Kg) *</label>
            <input type="number" id="pesoEmKg" formControlName="pesoEmKg" placeholder="Ex: 70">
          </div>
        </div>

        <div class="form-group">
          <label for="genero">Gênero *</label>
          <select id="genero" formControlName="genero">
            <option [value]="null" disabled>Selecione seu gênero</option>
            <option *ngFor="let genero of generos" [value]="genero.valor">
              {{ genero.texto }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="nivelDeAtividade">Nível de Atividade *</label>
          <select id="nivelDeAtividade" formControlName="nivelDeAtividade">
            <option [value]="null" disabled>Selecione seu nível de atividade</option>
            <option *ngFor="let nivel of niveisAtividade" [value]="nivel.valor">
              {{ nivel.texto }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="objetivo">Objetivo *</label>
          <select id="objetivo" formControlName="objetivo">
            <option [value]="null" disabled>Selecione seu objetivo</option>
            <option *ngFor="let obj of objetivos" [value]="obj.valor">
              {{ obj.texto }}
            </option>
          </select>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="toggleEditMode()">Cancelar</button>
          <button type="submit" class="btn-save" [disabled]="profileForm.invalid">Salvar Alterações</button>
        </div>
      </form>
    </section>
    
  </div>
</div>